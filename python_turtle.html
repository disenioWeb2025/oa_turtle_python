
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêç IDE Python Educativo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2196F3, #21CBF3);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 { 
            font-size: 2.5em; 
            margin-bottom: 10px; 
        }
        
        .header p { 
            font-size: 1.1em; 
            opacity: 0.9; 
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 1fr;
            gap: 20px;
            padding: 20px;
            min-height: 600px;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .examples-panel, .editor-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #e9ecef;
        }

        .examples-panel h3, .editor-panel h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .example-item {
            background: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #dee2e6;
            transition: all 0.3s ease;
        }

        .example-item:hover {
            background: #e3f2fd;
            border-color: #2196F3;
            transform: translateY(-2px);
        }

        .example-item h4 {
            color: #2196F3;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .example-item p {
            color: #6c757d;
            font-size: 0.8em;
            line-height: 1.4;
        }

        .code-editor {
            width: 100%;
            height: 400px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 15px;
            resize: none;
            background: #ffffff;
            color: #212529;
            line-height: 1.5;
        }

        .code-editor:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .output-panel {
            background: #1a1a1a;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #333;
        }

        .output-panel h3 { 
            color: #ffffff; 
            margin-bottom: 15px; 
        }

        .output-content {
            background: #000000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 15px;
            height: 350px;
            border-radius: 8px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-size: 13px;
            line-height: 1.4;
        }

        /* Canvas flotante para turtle */
        #turtle-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        #turtle-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            position: relative;
        }

        #turtle-canvas {
            border: 3px solid #2196F3;
            border-radius: 8px;
            background: white;
            display: block;
        }

        .canvas-close-btn {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 30px;
            height: 30px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
        }

        .btn {
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 14px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-ejecutar {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .btn-limpiar {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .status {
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            font-weight: 500;
        }

        .loading { 
            background: #fff3cd; 
            color: #856404; 
        }
        
        .ready { 
            background: #d4edda; 
            color: #155724; 
        }
        
        .error { 
            background: #f8d7da; 
            color: #721c24; 
        }

        .note {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üêç IDE Python Educativo</h1>
            <p>Aprende Python directamente en tu navegador - Con Turtle Graphics</p>
        </div>

        <div id="status" class="status loading">Cargando Python...</div>

        <div class="control-buttons">
            <button id="run-btn" class="btn btn-ejecutar" onclick="ejecutarCodigo()">
                ‚ñ∂Ô∏è Ejecutar
            </button>
            <button class="btn btn-limpiar" onclick="limpiarEditor()">
                üóëÔ∏è Limpiar
            </button>
        </div>

        <div class="main-content">
            <div class="examples-panel">
                <h3>üìö Ejemplos</h3>
                
                <div class="example-item" onclick="cargarEjemplo('hola')">
                    <h4>Hola Mundo</h4>
                    <p>Variables y operaciones b√°sicas</p>
                </div>

                <div class="example-item" onclick="cargarEjemplo('turtle_cuadrado')">
                    <h4>üê¢ Cuadrado</h4>
                    <p>Dibujar un cuadrado simple</p>
                </div>

                <div class="example-item" onclick="cargarEjemplo('turtle_estrella')">
                    <h4>‚≠ê Estrella</h4>
                    <p>Dibujar una estrella</p>
                </div>

                <div class="example-item" onclick="cargarEjemplo('turtle_espiral')">
                    <h4>üåÄ Espiral</h4>
                    <p>Crear una espiral colorida</p>
                </div>

                <div class="example-item" onclick="cargarEjemplo('turtle_flor')">
                    <h4>üå∏ Flor</h4>
                    <p>Dibujar una flor con p√©talos</p>
                </div>
            </div>

            <div class="editor-panel">
                <div class="note">
                    ‚úÖ Turtle graphics funcionando correctamente
                </div>
                <h3>‚úèÔ∏è Editor de C√≥digo</h3>
                <textarea id="code-editor" class="code-editor" placeholder="Escribe tu c√≥digo Python aqu√≠..."># Ejemplo b√°sico con turtle
import turtle

# Dibujar un cuadrado
for i in range(4):
    turtle.forward(100)
    turtle.right(90)

print("¬°Cuadrado dibujado!")</textarea>
            </div>

            <div class="output-panel">
                <h3>üñ•Ô∏è Salida del Programa</h3>
                <div id="output" class="output-content">Python 3.10 | Pyodide
Ejecuta tu c√≥digo para ver la salida...</div>
            </div>
        </div>
    </div>

    <!-- Canvas flotante para turtle -->
    <div id="turtle-overlay">
        <div id="turtle-container">
            <canvas id="turtle-canvas" width="600" height="400"></canvas>
            <button class="canvas-close-btn" onclick="cerrarTurtle()">√ó</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script>
        let pyodide;
        let isLoading = true;

        // Ejemplos de c√≥digo
        const ejemplos = {
            hola: `# Mi primer programa en Python
print("¬°Hola, mundo!")

# Variables
nombre = "Estudiante" 
edad = 15
print(f"Hola {nombre}, tienes {edad} a√±os")`,

            turtle_cuadrado: `# Dibujar un cuadrado con turtle
import turtle

print("Dibujando un cuadrado...")

# Configurar turtle
turtle.color('blue')
turtle.pendown()

# Dibujar cuadrado
for i in range(4):
    turtle.forward(100)
    turtle.right(90)

print("¬°Cuadrado completado!")`,

            turtle_estrella: `# Dibujar una estrella
import turtle

print("Dibujando una estrella...")

turtle.color('red')
turtle.pendown()

# Dibujar estrella de 5 puntas
for i in range(5):
    turtle.forward(100)
    turtle.right(144)

print("¬°Estrella completada!")`,

            turtle_espiral: `# Crear una espiral colorida
import turtle

print("Creando espiral colorida...")

colores = ['red', 'blue', 'green', 'yellow', 'orange', 'purple']
turtle.speed(10)

for i in range(100):
    turtle.color(colores[i % len(colores)])
    turtle.forward(i * 2)
    turtle.right(91)

print("¬°Espiral completada!")`,

            turtle_flor: `# Dibujar una flor con p√©talos
import turtle

print("Dibujando una flor...")

def dibujar_petalo():
    turtle.circle(30, 60)
    turtle.left(120)
    turtle.circle(30, 60)

turtle.color('pink')
turtle.speed(8)

# Dibujar 6 p√©talos
for i in range(6):
    dibujar_petalo()
    turtle.right(60)

# Dibujar centro
turtle.color('yellow')
turtle.penup()
turtle.goto(0, -10)
turtle.pendown()
turtle.circle(10)

print("¬°Flor completada!")
turtle.penup()
turtle.goto(0, 0)`
        };

        function cargarEjemplo(tipo) {
            if (ejemplos[tipo]) {
                document.getElementById('code-editor').value = ejemplos[tipo];
            }
        }

        function mostrarTurtle() {
            document.getElementById('turtle-overlay').style.display = 'flex';
        }

        function cerrarTurtle() {
            document.getElementById('turtle-overlay').style.display = 'none';
        }

        // M√≥dulo turtle mejorado
        function setupTurtleModule() {
            return `
import math
import js

class Turtle:
    def __init__(self):
        self.canvas = None
        self.ctx = None
        self.x = 300  # Centro del canvas
        self.y = 200
        self.angle = 0  # √Ångulo en grados, 0 = derecha
        self.pen_down = True
        self.color_actual = 'black'
        self.speed_val = 6
        
    def _get_canvas(self):
        if self.canvas is None:
            js.mostrarTurtle()  # Mostrar el canvas
            self.canvas = js.document.getElementById('turtle-canvas')
            self.ctx = self.canvas.getContext('2d')
            # Limpiar canvas
            self.ctx.fillStyle = 'white'
            self.ctx.fillRect(0, 0, 600, 400)
            # Configurar estilo
            self.ctx.strokeStyle = self.color_actual
            self.ctx.lineWidth = 2
            self.ctx.lineCap = 'round'
        return self.ctx
    
    def forward(self, distance):
        ctx = self._get_canvas()
        
        # Calcular nueva posici√≥n
        rad = math.radians(self.angle)
        new_x = self.x + distance * math.cos(rad)
        new_y = self.y + distance * math.sin(rad)
        
        if self.pen_down:
            ctx.beginPath()
            ctx.moveTo(self.x, self.y)
            ctx.lineTo(new_x, new_y)
            ctx.stroke()
        
        self.x = new_x
        self.y = new_y
    
    def backward(self, distance):
        self.forward(-distance)
    
    def right(self, angle):
        self.angle += angle
    
    def left(self, angle):
        self.angle -= angle
    
    def penup(self):
        self.pen_down = False
    
    def pendown(self):
        self.pen_down = True
    
    def goto(self, x, y):
        ctx = self._get_canvas()
        
        # Convertir coordenadas (centro del canvas como 0,0)
        canvas_x = x + 300
        canvas_y = 200 - y
        
        if self.pen_down:
            ctx.beginPath()
            ctx.moveTo(self.x, self.y)
            ctx.lineTo(canvas_x, canvas_y)
            ctx.stroke()
        
        self.x = canvas_x
        self.y = canvas_y
    
    def circle(self, radius, extent=360):
        ctx = self._get_canvas()
        
        if self.pen_down:
            # Convertir extent de grados a radianes
            start_angle = 0
            end_angle = math.radians(extent)
            
            ctx.beginPath()
            if radius > 0:
                ctx.arc(self.x, self.y - radius, abs(radius), start_angle, end_angle)
            else:
                ctx.arc(self.x, self.y + abs(radius), abs(radius), start_angle, end_angle)
            ctx.stroke()
    
    def color(self, color_name):
        self.color_actual = str(color_name)
        if self.ctx:
            self.ctx.strokeStyle = self.color_actual
            self.ctx.fillStyle = self.color_actual
    
    def speed(self, speed):
        self.speed_val = speed
    
    def clear(self):
        if self.canvas:
            self.ctx.fillStyle = 'white'
            self.ctx.fillRect(0, 0, 600, 400)
            self.ctx.strokeStyle = self.color_actual
        self.x = 300
        self.y = 200
        self.angle = 0

# Instancia global de turtle
_turtle_instance = Turtle()

# Funciones del m√≥dulo turtle
def forward(distance):
    _turtle_instance.forward(distance)

def backward(distance):
    _turtle_instance.backward(distance)

def right(angle):
    _turtle_instance.right(angle)

def left(angle):
    _turtle_instance.left(angle)

def penup():
    _turtle_instance.penup()

def pendown():
    _turtle_instance.pendown()

def goto(x, y):
    _turtle_instance.goto(x, y)

def circle(radius, extent=360):
    _turtle_instance.circle(radius, extent)

def color(color_name):
    _turtle_instance.color(color_name)

def speed(speed):
    _turtle_instance.speed(speed)

def clear():
    _turtle_instance.clear()

# Aliases comunes
fd = forward
bk = backward
rt = right
lt = left
pu = penup
pd = pendown
`;
        }

        async function inicializarPyodide() {
            const outputElement = document.getElementById('output');
            const statusElement = document.getElementById('status');
            
            try {
                statusElement.textContent = 'Cargando Python...';
                statusElement.className = 'status loading';
                
                pyodide = await loadPyodide();
                
                statusElement.textContent = 'Configurando turtle...';
                
                // Configurar funci√≥n para mostrar turtle desde Python
                window.mostrarTurtle = mostrarTurtle;
                
                // Configurar el m√≥dulo turtle
                pyodide.runPython(`
import sys
import types

# Crear m√≥dulo turtle
${setupTurtleModule()}

# Registrar m√≥dulo
turtle_module = types.ModuleType('turtle')
for name in ['forward', 'backward', 'right', 'left', 'penup', 'pendown', 
             'goto', 'circle', 'color', 'speed', 'clear', 'fd', 'bk', 'rt', 'lt', 'pu', 'pd']:
    if name in globals():
        setattr(turtle_module, name, globals()[name])

sys.modules['turtle'] = turtle_module
print("M√≥dulo turtle configurado correctamente")
                `);
                
                statusElement.textContent = '‚úÖ Python y Turtle listos';
                statusElement.className = 'status ready';
                isLoading = false;
                outputElement.textContent = 'Python 3.10 | Pyodide\nüê¢ Turtle graphics listos\nEjecuta tu c√≥digo para ver la salida...';
                
            } catch (error) {
                outputElement.textContent = `Error al cargar Python: ${error.message}`;
                statusElement.textContent = '‚ùå Error al cargar';
                statusElement.className = 'status error';
            }
        }

        async function ejecutarCodigo() {
            if (isLoading) {
                alert('Python a√∫n se est√° cargando. Por favor espera...');
                return;
            }

            const codigo = document.getElementById('code-editor').value;
            const outputElement = document.getElementById('output');
            const runBtn = document.getElementById('run-btn');
            
            runBtn.disabled = true;
            runBtn.textContent = '‚è≥ Ejecutando...';
            
            outputElement.textContent = 'Ejecutando c√≥digo...\n\n';

            try {
                // Configurar captura de salida
                pyodide.runPython(`
import sys
from io import StringIO

# Capturar stdout
stdout_backup = sys.stdout
sys.stdout = StringIO()
                `);
                
                // Ejecutar c√≥digo del usuario
                pyodide.runPython(codigo);
                
                // Obtener salida y restaurar stdout
                const output = pyodide.runPython(`
output = sys.stdout.getvalue()
sys.stdout = stdout_backup
output
                `);
                
                outputElement.textContent = output || 'C√≥digo ejecutado correctamente.';
                
            } catch (error) {
                outputElement.textContent = `Error: ${error.message}`;
            } finally {
                runBtn.disabled = false;
                runBtn.textContent = '‚ñ∂Ô∏è Ejecutar';
            }
        }

        function limpiarEditor() {
            document.getElementById('code-editor').value = '';
            document.getElementById('output').textContent = 'Python 3.10 | Pyodide\nEjecuta tu c√≥digo para ver la salida...';
            cerrarTurtle();
            
            // Limpiar canvas si existe
            if (pyodide) {
                try {
                    pyodide.runPython('clear()');
                } catch (e) {
                    console.log('Canvas ya limpio');
                }
            }
        }

        // Inicializar cuando se carga la p√°gina
        window.addEventListener('load', inicializarPyodide);
    </script>
</body>
</html>
